Only in step1/mimir-distributed/charts: rollout_operator
diff -c -r step0/mimir-distributed/templates/alertmanager/alertmanager-statefulset.yaml step1/mimir-distributed/templates/alertmanager/alertmanager-statefulset.yaml
*** step0/mimir-distributed/templates/alertmanager/alertmanager-statefulset.yaml	2022-09-13 08:13:10.674634731 +0200
--- step1/mimir-distributed/templates/alertmanager/alertmanager-statefulset.yaml	2022-09-13 08:13:20.098747132 +0200
***************
*** 113,115 ****
--- 113,487 ----
              readOnlyRootFilesystem: true
            env:
            envFrom:
+ ---
+ # Source: mimir-distributed/templates/alertmanager/alertmanager-statefulset.yaml
+ apiVersion: apps/v1
+ kind: StatefulSet
+ metadata:
+   name: krajo-mimir-alertmanager-zone-a
+   labels:
+     helm.sh/chart: mimir-distributed-3.1.0-weekly.202
+     app.kubernetes.io/name: mimir
+     app.kubernetes.io/instance: krajo
+     app.kubernetes.io/component: alertmanager
+     app.kubernetes.io/part-of: memberlist
+     app.kubernetes.io/version: "r202"
+     app.kubernetes.io/managed-by: Helm
+     name: "alertmanager-zone-a"
+     rollout-group: alertmanager
+     zone: zone-a
+   annotations:
+     rollout-max-unavailable: "2"
+   namespace: "default"
+ spec:
+   replicas: 0
+   selector:
+     matchLabels:
+       app.kubernetes.io/name: mimir
+       app.kubernetes.io/instance: krajo
+       app.kubernetes.io/component: alertmanager
+       rollout-group: alertmanager
+       zone: zone-a
+   updateStrategy:
+     type: OnDelete
+   serviceName: krajo-mimir-alertmanager
+   volumeClaimTemplates:
+     - metadata:
+         name: storage
+       spec:
+         accessModes:
+           - ReadWriteOnce
+         resources:
+           requests:
+             storage: "1Gi"
+   template:
+     metadata:
+       labels:
+         helm.sh/chart: mimir-distributed-3.1.0-weekly.202
+         app.kubernetes.io/name: mimir
+         app.kubernetes.io/instance: krajo
+         app.kubernetes.io/version: "r202"
+         app.kubernetes.io/managed-by: Helm
+         app.kubernetes.io/component: alertmanager
+         app.kubernetes.io/part-of: memberlist
+         name: "alertmanager-zone-a"
+         rollout-group: alertmanager
+         zone: zone-a
+       annotations:
+       namespace: "default"
+     spec:
+       serviceAccountName: krajo-mimir
+       securityContext:
+         {}
+       initContainers:
+         []
+       nodeSelector:
+         {}
+       affinity:
+         {}
+       tolerations:
+         []
+       terminationGracePeriodSeconds: 60
+       volumes:
+         - name: config
+           configMap:
+             name: krajo-mimir-config
+             items:
+               - key: "mimir.yaml"
+                 path: "mimir.yaml"
+         - name: runtime-config
+           configMap:
+             name: krajo-mimir-runtime
+         - name: tmp
+           emptyDir: {}
+       containers:
+         - name: alertmanager
+           image: "grafana/mimir:r202-d1db3dc"
+           imagePullPolicy: IfNotPresent
+           args:
+             - "-target=alertmanager"
+             - "-config.expand-env=true"
+             - "-config.file=/etc/mimir/mimir.yaml"
+             - "-alertmanager.sharding-ring.instance-availability-zone=zone-a"
+           volumeMounts:
+             - name: config
+               mountPath: /etc/mimir
+             - name: runtime-config
+               mountPath: /var/mimir
+             - name: storage
+               mountPath: "/data"
+             - name: tmp
+               mountPath: /tmp
+           ports:
+             - name: http-metrics
+               containerPort: 8080
+               protocol: TCP
+             - name: grpc
+               containerPort: 9095
+               protocol: TCP
+             - name: memberlist
+               containerPort: 7946
+               protocol: TCP
+           livenessProbe:
+             null
+           readinessProbe:
+             httpGet:
+               path: /ready
+               port: http-metrics
+             initialDelaySeconds: 45
+           resources:
+             requests:
+               cpu: 10m
+               memory: 32Mi
+           securityContext:
+             readOnlyRootFilesystem: true
+           env:
+           envFrom:
+ ---
+ # Source: mimir-distributed/templates/alertmanager/alertmanager-statefulset.yaml
+ apiVersion: apps/v1
+ kind: StatefulSet
+ metadata:
+   name: krajo-mimir-alertmanager-zone-b
+   labels:
+     helm.sh/chart: mimir-distributed-3.1.0-weekly.202
+     app.kubernetes.io/name: mimir
+     app.kubernetes.io/instance: krajo
+     app.kubernetes.io/component: alertmanager
+     app.kubernetes.io/part-of: memberlist
+     app.kubernetes.io/version: "r202"
+     app.kubernetes.io/managed-by: Helm
+     name: "alertmanager-zone-b"
+     rollout-group: alertmanager
+     zone: zone-b
+   annotations:
+     rollout-max-unavailable: "2"
+   namespace: "default"
+ spec:
+   replicas: 0
+   selector:
+     matchLabels:
+       app.kubernetes.io/name: mimir
+       app.kubernetes.io/instance: krajo
+       app.kubernetes.io/component: alertmanager
+       rollout-group: alertmanager
+       zone: zone-b
+   updateStrategy:
+     type: OnDelete
+   serviceName: krajo-mimir-alertmanager
+   volumeClaimTemplates:
+     - metadata:
+         name: storage
+       spec:
+         accessModes:
+           - ReadWriteOnce
+         resources:
+           requests:
+             storage: "1Gi"
+   template:
+     metadata:
+       labels:
+         helm.sh/chart: mimir-distributed-3.1.0-weekly.202
+         app.kubernetes.io/name: mimir
+         app.kubernetes.io/instance: krajo
+         app.kubernetes.io/version: "r202"
+         app.kubernetes.io/managed-by: Helm
+         app.kubernetes.io/component: alertmanager
+         app.kubernetes.io/part-of: memberlist
+         name: "alertmanager-zone-b"
+         rollout-group: alertmanager
+         zone: zone-b
+       annotations:
+       namespace: "default"
+     spec:
+       serviceAccountName: krajo-mimir
+       securityContext:
+         {}
+       initContainers:
+         []
+       nodeSelector:
+         {}
+       affinity:
+         {}
+       tolerations:
+         []
+       terminationGracePeriodSeconds: 60
+       volumes:
+         - name: config
+           configMap:
+             name: krajo-mimir-config
+             items:
+               - key: "mimir.yaml"
+                 path: "mimir.yaml"
+         - name: runtime-config
+           configMap:
+             name: krajo-mimir-runtime
+         - name: tmp
+           emptyDir: {}
+       containers:
+         - name: alertmanager
+           image: "grafana/mimir:r202-d1db3dc"
+           imagePullPolicy: IfNotPresent
+           args:
+             - "-target=alertmanager"
+             - "-config.expand-env=true"
+             - "-config.file=/etc/mimir/mimir.yaml"
+             - "-alertmanager.sharding-ring.instance-availability-zone=zone-b"
+           volumeMounts:
+             - name: config
+               mountPath: /etc/mimir
+             - name: runtime-config
+               mountPath: /var/mimir
+             - name: storage
+               mountPath: "/data"
+             - name: tmp
+               mountPath: /tmp
+           ports:
+             - name: http-metrics
+               containerPort: 8080
+               protocol: TCP
+             - name: grpc
+               containerPort: 9095
+               protocol: TCP
+             - name: memberlist
+               containerPort: 7946
+               protocol: TCP
+           livenessProbe:
+             null
+           readinessProbe:
+             httpGet:
+               path: /ready
+               port: http-metrics
+             initialDelaySeconds: 45
+           resources:
+             requests:
+               cpu: 10m
+               memory: 32Mi
+           securityContext:
+             readOnlyRootFilesystem: true
+           env:
+           envFrom:
+ ---
+ # Source: mimir-distributed/templates/alertmanager/alertmanager-statefulset.yaml
+ apiVersion: apps/v1
+ kind: StatefulSet
+ metadata:
+   name: krajo-mimir-alertmanager-zone-c
+   labels:
+     helm.sh/chart: mimir-distributed-3.1.0-weekly.202
+     app.kubernetes.io/name: mimir
+     app.kubernetes.io/instance: krajo
+     app.kubernetes.io/component: alertmanager
+     app.kubernetes.io/part-of: memberlist
+     app.kubernetes.io/version: "r202"
+     app.kubernetes.io/managed-by: Helm
+     name: "alertmanager-zone-c"
+     rollout-group: alertmanager
+     zone: zone-c
+   annotations:
+     rollout-max-unavailable: "2"
+   namespace: "default"
+ spec:
+   replicas: 0
+   selector:
+     matchLabels:
+       app.kubernetes.io/name: mimir
+       app.kubernetes.io/instance: krajo
+       app.kubernetes.io/component: alertmanager
+       rollout-group: alertmanager
+       zone: zone-c
+   updateStrategy:
+     type: OnDelete
+   serviceName: krajo-mimir-alertmanager
+   volumeClaimTemplates:
+     - metadata:
+         name: storage
+       spec:
+         accessModes:
+           - ReadWriteOnce
+         resources:
+           requests:
+             storage: "1Gi"
+   template:
+     metadata:
+       labels:
+         helm.sh/chart: mimir-distributed-3.1.0-weekly.202
+         app.kubernetes.io/name: mimir
+         app.kubernetes.io/instance: krajo
+         app.kubernetes.io/version: "r202"
+         app.kubernetes.io/managed-by: Helm
+         app.kubernetes.io/component: alertmanager
+         app.kubernetes.io/part-of: memberlist
+         name: "alertmanager-zone-c"
+         rollout-group: alertmanager
+         zone: zone-c
+       annotations:
+       namespace: "default"
+     spec:
+       serviceAccountName: krajo-mimir
+       securityContext:
+         {}
+       initContainers:
+         []
+       nodeSelector:
+         {}
+       affinity:
+         {}
+       tolerations:
+         []
+       terminationGracePeriodSeconds: 60
+       volumes:
+         - name: config
+           configMap:
+             name: krajo-mimir-config
+             items:
+               - key: "mimir.yaml"
+                 path: "mimir.yaml"
+         - name: runtime-config
+           configMap:
+             name: krajo-mimir-runtime
+         - name: tmp
+           emptyDir: {}
+       containers:
+         - name: alertmanager
+           image: "grafana/mimir:r202-d1db3dc"
+           imagePullPolicy: IfNotPresent
+           args:
+             - "-target=alertmanager"
+             - "-config.expand-env=true"
+             - "-config.file=/etc/mimir/mimir.yaml"
+             - "-alertmanager.sharding-ring.instance-availability-zone=zone-c"
+           volumeMounts:
+             - name: config
+               mountPath: /etc/mimir
+             - name: runtime-config
+               mountPath: /var/mimir
+             - name: storage
+               mountPath: "/data"
+             - name: tmp
+               mountPath: /tmp
+           ports:
+             - name: http-metrics
+               containerPort: 8080
+               protocol: TCP
+             - name: grpc
+               containerPort: 9095
+               protocol: TCP
+             - name: memberlist
+               containerPort: 7946
+               protocol: TCP
+           livenessProbe:
+             null
+           readinessProbe:
+             httpGet:
+               path: /ready
+               port: http-metrics
+             initialDelaySeconds: 45
+           resources:
+             requests:
+               cpu: 10m
+               memory: 32Mi
+           securityContext:
+             readOnlyRootFilesystem: true
+           env:
+           envFrom:
diff -c -r step0/mimir-distributed/templates/alertmanager/alertmanager-svc.yaml step1/mimir-distributed/templates/alertmanager/alertmanager-svc.yaml
*** step0/mimir-distributed/templates/alertmanager/alertmanager-svc.yaml	2022-09-13 08:13:10.674634731 +0200
--- step1/mimir-distributed/templates/alertmanager/alertmanager-svc.yaml	2022-09-13 08:13:20.098747132 +0200
***************
*** 30,32 ****
--- 30,146 ----
      app.kubernetes.io/name: mimir
      app.kubernetes.io/instance: krajo
      app.kubernetes.io/component: alertmanager
+ ---
+ # Source: mimir-distributed/templates/alertmanager/alertmanager-svc.yaml
+ apiVersion: v1
+ kind: Service
+ metadata:
+   name: krajo-mimir-alertmanager-zone-a
+   labels:
+     helm.sh/chart: mimir-distributed-3.1.0-weekly.202
+     app.kubernetes.io/name: mimir
+     app.kubernetes.io/instance: krajo
+     app.kubernetes.io/component: alertmanager
+     app.kubernetes.io/part-of: memberlist
+     app.kubernetes.io/version: "r202"
+     app.kubernetes.io/managed-by: Helm
+     name: "alertmanager-zone-a"
+     rollout-group: alertmanager
+     zone: zone-a
+     prometheus.io/service-monitor: "false"
+   annotations:
+     {}
+   namespace: "default"
+ spec:
+   type: ClusterIP
+   ports:
+     - port: 8080
+       protocol: TCP
+       name: http-metrics
+       targetPort: http-metrics
+     - port: 9095
+       protocol: TCP
+       name: grpc
+       targetPort: grpc
+   selector:
+     app.kubernetes.io/name: mimir
+     app.kubernetes.io/instance: krajo
+     app.kubernetes.io/component: alertmanager
+     rollout-group: alertmanager
+     zone: zone-a
+ ---
+ # Source: mimir-distributed/templates/alertmanager/alertmanager-svc.yaml
+ apiVersion: v1
+ kind: Service
+ metadata:
+   name: krajo-mimir-alertmanager-zone-b
+   labels:
+     helm.sh/chart: mimir-distributed-3.1.0-weekly.202
+     app.kubernetes.io/name: mimir
+     app.kubernetes.io/instance: krajo
+     app.kubernetes.io/component: alertmanager
+     app.kubernetes.io/part-of: memberlist
+     app.kubernetes.io/version: "r202"
+     app.kubernetes.io/managed-by: Helm
+     name: "alertmanager-zone-b"
+     rollout-group: alertmanager
+     zone: zone-b
+     prometheus.io/service-monitor: "false"
+   annotations:
+     {}
+   namespace: "default"
+ spec:
+   type: ClusterIP
+   ports:
+     - port: 8080
+       protocol: TCP
+       name: http-metrics
+       targetPort: http-metrics
+     - port: 9095
+       protocol: TCP
+       name: grpc
+       targetPort: grpc
+   selector:
+     app.kubernetes.io/name: mimir
+     app.kubernetes.io/instance: krajo
+     app.kubernetes.io/component: alertmanager
+     rollout-group: alertmanager
+     zone: zone-b
+ ---
+ # Source: mimir-distributed/templates/alertmanager/alertmanager-svc.yaml
+ apiVersion: v1
+ kind: Service
+ metadata:
+   name: krajo-mimir-alertmanager-zone-c
+   labels:
+     helm.sh/chart: mimir-distributed-3.1.0-weekly.202
+     app.kubernetes.io/name: mimir
+     app.kubernetes.io/instance: krajo
+     app.kubernetes.io/component: alertmanager
+     app.kubernetes.io/part-of: memberlist
+     app.kubernetes.io/version: "r202"
+     app.kubernetes.io/managed-by: Helm
+     name: "alertmanager-zone-c"
+     rollout-group: alertmanager
+     zone: zone-c
+     prometheus.io/service-monitor: "false"
+   annotations:
+     {}
+   namespace: "default"
+ spec:
+   type: ClusterIP
+   ports:
+     - port: 8080
+       protocol: TCP
+       name: http-metrics
+       targetPort: http-metrics
+     - port: 9095
+       protocol: TCP
+       name: grpc
+       targetPort: grpc
+   selector:
+     app.kubernetes.io/name: mimir
+     app.kubernetes.io/instance: krajo
+     app.kubernetes.io/component: alertmanager
+     rollout-group: alertmanager
+     zone: zone-c
diff -c -r step0/mimir-distributed/templates/mimir-config.yaml step1/mimir-distributed/templates/mimir-config.yaml
*** step0/mimir-distributed/templates/mimir-config.yaml	2022-09-13 08:13:10.674634731 +0200
--- step1/mimir-distributed/templates/mimir-config.yaml	2022-09-13 08:13:20.094747092 +0200
***************
*** 22,27 ****
--- 22,28 ----
        external_url: /alertmanager
        sharding_ring:
          instance_availability_zone: default
+         zone_awareness_enabled: true
      alertmanager_storage:
        backend: s3
        s3:
